<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>ANOVA</title>
    <meta charset="utf-8" />
    <meta name="author" content="Dra. Stephanie Hereira Pacheco" />
    <script src="Clase2-ANOVA_files/header-attrs-2.30/header-attrs.js"></script>
    <script src="Clase2-ANOVA_files/jquery-3.6.0/jquery-3.6.0.min.js"></script>
    <script src="Clase2-ANOVA_files/clipboard-2.0.6/clipboard.min.js"></script>
    <link href="Clase2-ANOVA_files/xaringanExtra-clipboard-0.2.6/xaringanExtra-clipboard.css" rel="stylesheet" />
    <script src="Clase2-ANOVA_files/xaringanExtra-clipboard-0.2.6/xaringanExtra-clipboard.js"></script>
    <script>window.xaringanExtraClipboard(null, {"button":"<i class=\"fa fa-clipboard\"><\/i>","success":"<i class=\"fa fa-check\" style=\"color: #90BE6D\"><\/i>","error":"Press Ctrl+C to Copy"})</script>
    <link href="Clase2-ANOVA_files/font-awesome-6.5.2/css/all.min.css" rel="stylesheet" />
    <link href="Clase2-ANOVA_files/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet" />
    <link href="Clase2-ANOVA_files/tile-view-0.2.6/tile-view.css" rel="stylesheet" />
    <script src="Clase2-ANOVA_files/tile-view-0.2.6/tile-view.js"></script>
    <link href="Clase2-ANOVA_files/shareon-1.4.1/shareon.min.css" rel="stylesheet" />
    <script src="Clase2-ANOVA_files/shareon-1.4.1/shareon.min.js"></script>
    <link href="Clase2-ANOVA_files/xaringanExtra-shareagain-0.2.6/shareagain.css" rel="stylesheet" />
    <script src="Clase2-ANOVA_files/xaringanExtra-shareagain-0.2.6/shareagain.js"></script>
    <link rel="stylesheet" href="xaringan-themer.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

.title[
# ANOVA
]
.subtitle[
## <img src="logo.jpg" style="width:2in" />
]
.author[
### Dra. Stephanie Hereira Pacheco
]
.institute[
### CICB, UATx
]
.date[
### 02-03-2024
]

---








<div>
<style type="text/css">.xaringan-extra-logo {
width: 110px;
height: 128px;
z-index: 0;
background-image: url(https://www.ciisder.mx/images/logos/logo_uatx_2019.png);
background-size: contain;
background-repeat: no-repeat;
position: absolute;
top:1em;right:1em;
}
</style>
<script>(function () {
  let tries = 0
  function addLogo () {
    if (typeof slideshow === 'undefined') {
      tries += 1
      if (tries < 10) {
        setTimeout(addLogo, 100)
      }
    } else {
      document.querySelectorAll('.remark-slide-content:not(.title-slide):not(.inverse):not(.hide_logo)')
        .forEach(function (slide) {
          const logo = document.createElement('div')
          logo.classList = 'xaringan-extra-logo'
          logo.href = null
          slide.appendChild(logo)
        })
    }
  }
  document.addEventListener('DOMContentLoaded', addLogo)
})()</script>
</div>





# Contenido

+ Análisis de varianza - ANOVA

+ Análisis de varianza de una vía

    
---
## Análisis de varianza - ANOVA

&lt;uw-blockquote&gt; La técnica de análisis de varianza (**ANOVA**) también conocida como análisis factorial y desarrollada por Fisher en 1930

&lt;uw-blockquote&gt; Este análisis constituye la herramienta básica para el estudio del **efecto de una o más variables independientes** (cada uno con dos o más niveles) sobre la media de **una variable continua**. 

---
## Análisis de varianza - ANOVA

&lt;uw-blockquote&gt;El análisis de varianza nos permite evaluar el efecto de `\(k\)` variables independientes y su interacción en un experimento. 

&lt;uw-blockquote&gt; En el ANOVA las variables independientes se denominan **factores**.


---

## Pero antes de seguir....

- ¿Sabes qué es una variable dependiente e independiente?

- ¿Qué es un factor y cuáles son sus niveles?

- ¿Qué es una variable continua y una variable discreta?

- ¿Qué es una interacción entre factores?

---
## Análisis de varianza - ANOVA

&lt;uw-blockquote&gt; Cuando existe una única variable independiente se denomina **Anova de un factor** (one way anova, en inglés), cuando son dos **Anova de dos vías** y cuando son más de dos, se denomina como **Anova factorial**.

---
# Pruebas paramétricas y supuestos estadísticos

Antes de comenzar, todas las pruebas estadísticas tienen supuestos...

- ¿Ya conocen alguna prueba estadística?

- ¿Qué supuestos tienen estas pruebas?

---
# Pruebas paramétricas 

&lt;uw-blockquote&gt;  Se conoce como estadística paramétrica a aquella que se basa en el muestreo de una población con una distribución conocida (**normal**) y con  parámetros fijos (**media poblacional, varianza o desviación estándar**). 

---
# Pruebas paramétricas


|VENTAJAS    | DESVENTAJAS     | 
|-------------------|-------|
| - Sensibles a rasgos de los datos recolectados  | - Más complicadas de calcular | 
| - Estimaciones probabilísticas más exactas       |- Solo se pueden aplicar si se cumplen sus supuestos   | 
| - Tienen una mayor eficiencia y poder estadístico      | - Los datos que se pueden observar son limitados| 

---
# Pruebas paramétricas

|TIPO    |   PRUEBA     | 
|:-------------------:|:-------:|
| Comparación de 2 grupos	  |   t de Student/Welch  | 
| Comparación de &gt;2 grupos       | **Anova**   | 
| Correlación de dos variables     | Coeficiente de Pearson| 
| Variables cualitativas     | Prueba de Z| 

---
# Pruebas paramétricas y supuestos estadísticos

Los supuestos de las pruebas paramétricas en general son:

- Distribución conocida (**normal**): visual y pruebas numéricas.

- Homocedasticidad: visual y pruebas numéricas.

- Otros: tamaño de la muestra, variables cuantitativas o continuas, outliers, aleatoriedad, independencia de las observaciones, linealidad. 

.

.center[*** Cada tipo de prueba paramétrica tiene sus propios supuestos***]
---


## Supuestos estadísticos del ANOVA

Los supuestos del ANOVA son:

- **Distribución normal de los residuales:** `\(\epsilon_{i,j} ∼ N(0,\sigma^2)\)`. Es decir, los errores (residuos) deben distribuirse normalmente con media 0 y varianza constante.

- **Homocedasticidad**: Todos los grupos comparten la misma varianza poblacional `\(σ²\)`

- **Aleatoriedad e independencia**
 
- **Otros**: Mismo número de observaciones por grupos, variable dependiente continua y variable independiente con tres o más grupos o niveles. 

---

### Distribución normal: métodos visuales

.pull-left[



``` r
data_normal&lt;- rnorm(200)
hist(data_normal, col='steelblue', main='Normal')
```

&lt;img src="Clase2-ANOVA_files/figure-html/unnamed-chunk-5-1.png" alt="" style="display: block; margin: auto;" /&gt;
]
.pull-right[



``` r
data_no_normal&lt;- rexp(100, rate=3)
hist(data_no_normal, col='red', main='No normal')
```

&lt;img src="Clase2-ANOVA_files/figure-html/unnamed-chunk-7-1.png" alt="" style="display: block; margin: auto;" /&gt;
]
---
### Distribución normal: métodos visuales

.pull-left[



``` r
plot(density(data_normal), main="Normal")
```

&lt;img src="Clase2-ANOVA_files/figure-html/unnamed-chunk-9-1.png" alt="" style="display: block; margin: auto;" /&gt;
]
.pull-right[


``` r
plot(density(data_no_normal), main="No Normal")
```

&lt;img src="Clase2-ANOVA_files/figure-html/unnamed-chunk-10-1.png" alt="" style="display: block; margin: auto;" /&gt;
]

---
### Distribución normal: métodos visuales

.pull-left[



``` r
qqnorm(data_normal)
qqline(data_normal)
```

&lt;img src="Clase2-ANOVA_files/figure-html/unnamed-chunk-12-1.png" alt="" style="display: block; margin: auto;" /&gt;
]
.pull-right[


``` r
qqnorm(data_no_normal)
qqline(data_no_normal)
```

&lt;img src="Clase2-ANOVA_files/figure-html/unnamed-chunk-13-1.png" alt="" style="display: block; margin: auto;" /&gt;
]
---
### Distribución normal: métodos numéricos

.pull-left[



``` r
shapiro.test(data_normal)
```

```
## 
## 	Shapiro-Wilk normality test
## 
## data:  data_normal
## W = 0.99076, p-value = 0.2298
```



``` r
ks.test(data_normal, "pnorm")
```

```
## 
## 	Asymptotic one-sample Kolmogorov-Smirnov test
## 
## data:  data_normal
## D = 0.053155, p-value = 0.6243
## alternative hypothesis: two-sided
```
]
.pull-right[


``` r
shapiro.test(data_no_normal)
```

```
## 
## 	Shapiro-Wilk normality test
## 
## data:  data_no_normal
## W = 0.89131, p-value = 5.641e-07
```


``` r
ks.test(data_no_normal, "pnorm")
```

```
## 
## 	Asymptotic one-sample Kolmogorov-Smirnov test
## 
## data:  data_no_normal
## D = 0.50783, p-value &lt; 2.2e-16
## alternative hypothesis: two-sided
```

]
---
### Probando heterocedasticidad
- Métodos visuales = Pruebas estadísticas de comparación y modelos lineales

.pull-left[




``` r
data("ToothGrowth")
boxplot(len ~ supp, data=ToothGrowth, col=c("red", "blue"), main="Dientes")
```

&lt;img src="Clase2-ANOVA_files/figure-html/unnamed-chunk-20-1.png" alt="" style="display: block; margin: auto;" /&gt;

]
.pull-right[


``` r
data("iris")
boxplot(Petal.Width ~ Species, data=iris, col=c("pink", "purple", "cyan"), main="Flores")
```

&lt;img src="Clase2-ANOVA_files/figure-html/unnamed-chunk-21-1.png" alt="" style="display: block; margin: auto;" /&gt;

]
---
## Probando heterocedasticidad
- Métodos visuales = Pruebas estadísticas de comparación y modelos lineales

.pull-left[

``` r
aggregate(len ~ supp, data = ToothGrowth, var)
```

```
##   supp      len
## 1   OJ 43.63344
## 2   VC 68.32723
```
Ratio

``` r
68.32 /  43.63
```

```
## [1] 1.565895
```

]
.pull-right[

``` r
aggregate(Petal.Width ~ Species, data = iris, var)
```

```
##      Species Petal.Width
## 1     setosa  0.01110612
## 2 versicolor  0.03910612
## 3  virginica  0.07543265
```
Ratio

``` r
r1&lt;-0.03910612 / 0.01110612 #versicolor vs setosa
r2&lt;-0.07543265 / 0.01110612 #virginca vs setosa
r3&lt;-0.07543264 / 0.03910612 #virginica vs versicolor
cbind(r1,r2,r3)
```

```
##            r1       r2       r3
## [1,] 3.521132 6.791989 1.928922
```
]
---
### Probando heterocedasticidad
.pull-left[

``` r
m1&lt;-lm(len ~ supp, data=ToothGrowth)
par(mfrow = c(1, 2))
plot(m1, which=c(1,3))
```

&lt;img src="Clase2-ANOVA_files/figure-html/unnamed-chunk-26-1.png" alt="" style="display: block; margin: auto;" /&gt;

]
.pull-right[


``` r
m2&lt;-lm(Petal.Width ~ Species, data=iris)
par(mfrow = c(1, 2))
plot(m2, which=c(1,3))
```

&lt;img src="Clase2-ANOVA_files/figure-html/unnamed-chunk-27-1.png" alt="" style="display: block; margin: auto;" /&gt;

]

---
### Probando heterocedasticidad


.pull-left[
Prueba para dos niveles = F



``` r
var.test(len ~ supp, data = ToothGrowth) 
```

```
## 
## 	F test to compare two variances
## 
## data:  len by supp
## F = 0.6386, num df = 29, denom df = 29, p-value = 0.2331
## alternative hypothesis: true ratio of variances is not equal to 1
## 95 percent confidence interval:
##  0.3039488 1.3416857
## sample estimates:
## ratio of variances 
##          0.6385951
```
]


.pull-right[


``` r
lmtest::bptest(m2) #sobre un modelo
```

```
## 
## 	studentized Breusch-Pagan test
## 
## data:  m2
## BP = 25.099, df = 2, p-value = 3.546e-06
```

``` r
library(car)
leveneTest(m2)
```

```
## Levene's Test for Homogeneity of Variance (center = median)
##        Df F value    Pr(&gt;F)    
## group   2  19.892 2.261e-08 ***
##       147                      
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
```


``` r
?fligner.test
```


]

&gt;- Otras pruebas: Prueba de Goldfeld-Quand, White, entre otras.



---
# Análisis de varianza de una vía
- El ANOVA de una vía es el tipo de análisis que se emplea cuando los datos no están pareados y se quiere estudiar si existen diferencias significativas entre las medias de una variable aleatoria continua en los diferentes niveles de otra variable cualitativa o factor.

+ Las hipótesis contrastadas en un ANOVA de un factor son:
  - `\(H_{0}\)` : No existen diferencias entre las medias de los grupos, es decir `\(\mu_{1}=\mu_{2}=....\mu_{k}\)`
  - `\(H_{1}\)` : Al menos un par de medias es significativamente diferente una de la otra


---
# Análisis de varianza de una vía
+ El ANOVA de una vía, crea una comparación entre la varianza en los datos que provienen de las diferencias entre grupos y la varianza en los datos que provienen de las diferencias dentro de los grupos.

 - `\(H_{0}\)` : `\(\sigma^2_{entre} = 0\)`    `\(\rightarrow\)` `\(\sigma^2_{entre}\)` + `\(\sigma^2_{dentro}\)` =  `\(\sigma^2_{dentro}\)`
 
 - `\(H_{1}\)` : `\(\sigma^2_{entre} &gt; 0\)`   `\(\rightarrow\)` `\(\sigma^2_{entre}\)` + `\(\sigma^2_{dentro}\)` &gt;  `\(\sigma^2_{dentro}\)`
 
- La forma en que el ANOVA hace esta comparación es evaluando las razones de las varianzas entre grupos y las varianzas dentro de los grupos: a nivel de población, si la razón es igual a 1, entonces las dos cosas son iguales, si la razón es mayor que uno, entonces la varianza entre grupos es al menos un poco mayor que 0 y esto lo conocemos como el **el estadístico F**.
---
# Análisis de varianza de una vía

### El estadístico F se calcula así: 

$$
`\begin{aligned}
F = \frac{\sigma^2_{entre}}{\sigma^2_{dentro}} = \frac{intervarianza}{intravarianza}= \frac{\frac{n\Sigma(\bar{x}_{k}-\bar{x})^2}{k-1}}{\frac{\Sigma(x_{k}-\bar{x_{k}})^2}{N-k}} = \frac{\frac{SCT}{k-1}}{\frac{SCE}{gl}}
\end{aligned}`
$$
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create();
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
// add `data-at-shortcutkeys` attribute to <body> to resolve conflicts with JAWS
// screen reader (see PR #262)
(function(d) {
  let res = {};
  d.querySelectorAll('.remark-help-content table tr').forEach(tr => {
    const t = tr.querySelector('td:nth-child(2)').innerText;
    tr.querySelectorAll('td:first-child .key').forEach(key => {
      const k = key.innerText;
      if (/^[a-z]$/.test(k)) res[k] = t;  // must be a single letter (key)
    });
  });
  d.body.setAttribute('data-at-shortcutkeys', JSON.stringify(res));
})(document);
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
